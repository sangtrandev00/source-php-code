<div class="shop-content">
    <div class="grid wide">
        <h3 class="shop-content__title section-heading">For Women</h3>
        <p class="shop-content__sub-title">Main / For Women</p>
        <div class="shop-content__divider"></div>
        <div class="shop-content__main">
            <!-- Shop content filter -->
            <div class="shop-content__side-bar">
                <div class="filter">
                    <form action="./index.php?act=shoppage" method="post">
                        <div class="filter__search">
                            <h3 class="filter__search-title">Your search</h3>
                            <input type="text" class="form-control" name="filterbyname"
                                placeholder="Search product ...">
                            <input type="submit" class="filter-btn btn  px-4 py-2" name="filterbtn" value="Search">
                        </div>
                    </form>

                    <div class="filter__filter-by">
                        <div class="filter-by">
                            <h3 class="filter-by__title">Filter by</h3>
                            <div class="filter-by__divider"></div>
                        </div>
                        <!-- Filter by collection -->
                        <div class="filter-by__collection">
                            <h4 class="filter-by__collection-title filter-by__cate-title">
                                <span class="">
                                    Catalog
                                </span>
                                <i class="fa-solid fa-minus filter-by__cate-title-icon "></i>
                            </h4>
                            <ul class="filter-by__collection-list filter-by__cate-list">
                                <li class="filter-by__collection__item filter-by__cate-item "><a
                                        href="./index.php?act=shoppage">All</a> </li>
                                <li class="filter-by__collection__item filter-by__cate-item"><a
                                        href="./index.php?act=shoppage&cateid=1">Cho Nam</a></li>
                                <li class="filter-by__collection__item filter-by__cate-item"><a
                                        href="./index.php?act=shoppage&cateid=2">Cho Nữ</a></li>
                                <li class="filter-by__collection__item filter-by__cate-item"><a
                                        href="./index.php?act=shoppage&cateid=3">Các loại giày</a></li>
                                <li class="filter-by__collection__item filter-by__cate-item"><a
                                        href="./index.php?act=shoppage&cateid=4">Các loại khác</a></li>
                                <!-- <li class="filter-by__collection__item filter-by__cate-item">New Arrivals
                                </li>
                                <li class="filter-by__collection__item filter-by__cate-item">Best sellers
                                </li> -->

                                <a href="" class="filter-by__collection__item-link show-more-link">Show
                                    more</a>
                            </ul>
                            <div class="filter-by__divider"></div>
                        </div>
                        <!--Filter by Price -->
                        <div class="filter-by__price">
                            <h4 class="filter-by__price-title filter-by__cate-title">
                                <span>Price</span>
                                <i class="fa-solid fa-minus filter-by__cate-title-icon"></i>
                            </h4>
                            <div class="filter-by__price-bars ">
                                <div class="filter-by__price-circle"></div>
                                <div class="filter-by__price-circle"></div>
                            </div>
                            <div class="filter-by__price-bars-price">
                                <span>$9.00</span> -
                                <span>$40.00</span>
                            </div>
                            <div class="filter-by__divider"></div>
                        </div>
                        <!-- Filter by color -->
                        <div class="filter-by__color">
                            <h4 class="filter-by__color-title filter-by__cate-title">
                                <span>Color</span>
                                <i class="fa-solid fa-minus filter-by__cate-title-icon"></i>
                            </h4>
                            <div class="filter-by__color-selections ">
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                                <div class="filter-by__color-item"></div>
                            </div>
                            <a href="" class="filter-by__color-link"></a>
                            <div class="filter-by__divider"></div>
                        </div>
                        <!-- Filter by size -->
                        <div class="filter-by__size">
                            <h4 class="filter-by__size-title filter-by__cate-title">
                                <span>Size</span>
                                <i class="fa-solid fa-minus filter-by__cate-title-icon"></i>
                            </h4>
                            <ul class="filter-by__size-list filter-by__cate-list">
                                <li class="filter-by__size-item filter-by__cate-item">
                                    <span class="filter-by__size-item-box">

                                    </span>
                                    <span class="filter-by__size-item-name">
                                        M
                                    </span>
                                </li>
                                <li class="filter-by__size-item filter-by__cate-item">
                                    <span class="filter-by__size-item-box">

                                    </span>
                                    <span class="filter-by__size-item-name">
                                        L
                                    </span>
                                </li>
                                <li class="filter-by__size-item filter-by__cate-item">
                                    <span class="filter-by__size-item-box">

                                    </span>
                                    <span class="filter-by__size-item-name">
                                        XL
                                    </span>
                                </li>
                                <a href="" class="filter-by__size-link show-more-link">Show more</a>
                                <div class="filter-by__divider"></div>
                        </div>
                    </div>
                    <!-- Filter by Rating -->
                    <div class="filter-by__rating">
                        <h4 class="filter-by__rating-title filter-by__cate-title">
                            <span>Rating</span>
                            <i class="fa-solid fa-minus filter-by__cate-title-icon"></i>
                        </h4>
                        <ul class="filter-by__rating-list filter-by__cate-list">
                            <li class="filter-by__rating-item filter-by__cate-item">
                                <div class="product-item__rating-stars">
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                                </div>
                            </li>
                            <li class="filter-by__rating-item filter-by__cate-item">
                                <div class="product-item__rating-stars">
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                                </div>
                            </li>
                            <li class="filter-by__rating-item filter-by__cate-item">
                                <div class="product-item__rating-stars">
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                                    <i
                                        class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                                </div>
                            </li>
                            <a href="" class="filter-by__rating-link show-more-link">Show more</a>
                        </ul>
                    </div>



                </div>
            </div>

            <!-- Shop content product section -->
            <div class="shop-content__section">
                <p class="shop-content__section-desc">
                    <!-- Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatibus mollitia quasi
                    harum
                    eligendi rerum! Quasi mollitia, fugiat sed asperiores vero veritatis debitis magnam
                    praesentium numquam ipsam amet eveniet cupiditate at?
                    Officia aperiam suscipit tempore itaque ratione hic velit quam maiores quod incidunt,
                    autem
                    accusantium voluptatem delectus eligendi dolore dolor voluptate tenetur. Laudantium
                    perspiciatis eligendi, sit nisi neque voluptas minima quo! -->
                </p>
                <div class="shop-content__section-products">
                    <div class="section-products">
                        <div class="section-products__sort">
                            <!-- <div class="section-products__sort-bar">
                                <span class="section-products__sort-bar-text">
                                    Default sorting
                                </span>
                                <i class="fa-solid fa-chevron-down fa-sm section-products__sort-bar-icon"></i>
                            </div> -->
                            <div class="section-products__view hide-on-mobile">
                                <span class="section-products__view-item"><img
                                        src="./assets/images/grid-view-icon/view-1-item.png" alt=""></span>
                                <span class="section-products__view-item">
                                    <img src="./assets/images/grid-view-icon/view-2-item.png" alt="">
                                </span>
                                <span class="section-products__view-item">
                                    <img src="./assets/images/grid-view-icon/view-4-item-in-row.png" alt="">
                                </span>
                            </div>
                            <!-- <div class="section-products__pagination hide-on-mobile">
                                <a href=""
                                    class="section-products__pagination-item section-products__pagination-item--current">1</a>
                                <a href="" class="section-products__pagination-item">2</a>
                                <a href=""
                                    class="section-products__pagination-item section-products__pagination-item--arrow-right">
                                    <i class=" fa-solid fa-arrow-right"></i>
                                </a>


                            </div> -->
                            <div
                                class="section-products__sort-bar section-products__sort-bar-mobile hide-on-pc hide-on-tablet">
                                <span class="section-products__sort-bar-text">
                                    Default sorting
                                </span>
                                <i class="fa-solid fa-chevron-down fa-sm section-products__sort-bar-icon"></i>
                                <ul class="section-products__sort-bar-list">
                                    <li class="section-products__sort-bar-item">
                                        <a href="./index.php?act=shoppage&sortbyprice=increase"
                                            class="section-products__sort-bar-item-link">Thứ tự theo giá: Thấp
                                            đến cao</a>
                                    </li>
                                    <li class="section-products__sort-bar-item">
                                        <a href="./index.php?act=shoppage&sortbyprice=descrease"
                                            class="section-products__sort-bar-item-link">Thứ tự theo giá: Cao đến
                                            thấp</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="section-products__list ">
                            <div class="product-list ">
                                <!-- PAGINATION function -->
                                <?php
$servername = "localhost";
$username = "asm_myclass";
$password = "trannhatsang10";

// PHẦN XỬ LÝ PHP
// B1: KET NOI CSDL
$conn = new PDO("mysql:host=$servername;dbname=asm_myclass", $username, $password);
// BƯỚC 2: TÌM TỔNG SỐ RECORDS
$sql_all = "SELECT * FROM tbl_sanpham";

if (isset($_GET["cateid"])) {
    $cateid = $_GET["cateid"];
    $sql_all .= " WHERE iddm =" . $cateid;
}

if (isset($_GET['sale']) && $_GET['sale'] == 1) {
    $sale = $_GET['sale'];
    $sql_all .= " WHERE sale =" . $sale;
}

if (isset($_POST['filterbtn']) && $_POST['filterbtn']) {
    $pattern = $_POST['filterbyname'];
    $sql_all .= " WHERE tensp like '%$pattern%'";
}

$stmt = $conn->prepare($sql_all);
$stmt->execute();

// set the resulting array to associative
$result = $stmt->setFetchMode(PDO::FETCH_ASSOC);
$finalresult = $stmt->fetchAll();
$total_records = count($finalresult);

// BƯỚC 3: TÌM LIMIT VÀ CURRENT_PAGE
$current_page = isset($_GET['page']) ? $_GET['page'] : 1;
$limit = 9;

// BƯỚC 4: TÍNH TOÁN TOTAL_PAGE VÀ START
// tổng số trang
$total_page = ceil($total_records / $limit);

// Giới hạn current_page trong khoảng 1 đến total_page
if ($current_page > $total_page) {
    $current_page = $total_page;
} else if ($current_page < 1) {
    $current_page = 1;
}

// Tìm Start
$start = ($current_page - 1) * $limit;

// BƯỚC 5: TRUY VẤN LẤY DANH SÁCH SẢN PHẨM

$sql = "SELECT * FROM tbl_sanpham WHERE 1";

if (isset($_GET['cateid'])) {
    $cateid = $_GET['cateid'];
    $sql .= " AND iddm=" . $cateid;
}

if (isset($_GET['sale']) && $_GET['sale'] == 1) {
    $sale = $_GET['sale'];
    $sql .= " AND sale = 1";
}

// Filter by price
if (isset($_GET['sortbyprice'])) {
    $sort_pattern = $_GET['sortbyprice'];
    // echo $sort_pattern;
    if ($sort_pattern == "increase") {
        $sql .= " ORDER BY giasp";
    } else if ($sort_pattern == "descrease") {
        $sql .= " ORDER BY giasp desc";
    }

}

if (isset($_POST['filterbtn']) && $_POST['filterbtn']) {
    $pattern = $_POST['filterbyname'];
    // echo $pattern;
    $sql .= " AND tensp like '%$pattern%'";
} else {
    $sql .= " LIMIT $start, $limit";
}

// Có limit và start rồi thì truy vấn CSDL lấy danh sách SẢN PHẨM

{
    $stmt2 = $conn->prepare($sql);
}

$stmt2->execute();
$productlist = $stmt2->fetchAll();
// var_dump($productlist);
foreach ($productlist as $product_item) {
    # code...
    $imgurl = substr($product_item['hinhanh1'], 3);
    $old_price = $product_item['giacu'] != 0 ? "$" . $product_item['giacu'] : "";
    echo '
    <tr>
        <div class="product-item product-col-4">
        <p class="product-item__bandage">New Arrival</p>
        <p class="product-item__sold-quantity">12 sold</p>
        <a href="index.php?act=detailpage&id=' . $product_item['id'] . '" class="product-item__img-container">
            <img src="' . $imgurl . '" alt=""
                class="product-item__img-img">
            <p class="product-item__img-quick-view">
                Quick View
            </p>
        </a>
        <div class="product-item__body">
            <a href="index.php?act=detailpage&id=' . $product_item['id'] . '" class="product-item__name">' . $product_item['tensp'] . '</a>
            <span class="product-item__divider"></span>
            <div class="product-item__price">
                <span class="product-item__price-old">' . $old_price . '</span>
                <span class="product-item__price-new">$' . $product_item['giasp'] . '</span>
            </div>

            <div class="product-item__rating-stars">
                <i
                    class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                <i
                    class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                <i
                    class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                <i
                    class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                <i
                    class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
            </div>

        </div>
        </div>
    </tr>
    ';

}

?>


                            </div>
                            <!-- Pagination bottom section -->
                            <!-- <div class="section-products__list-bottom">
                                <div class="section-products__list-bottom-spacing"></div>
                                <div class="section-products__list-bottom-pagination section-products__pagination">
                                    <a href=""
                                        class="section-products__pagination-item section-products__pagination-item--current">1</a>
                                    <a href="" class="section-products__pagination-item">2</a>
                                    <a href=""
                                        class="section-products__pagination-item section-products__pagination-item--arrow-right">
                                        <i class=" fa-solid fa-arrow-right"></i>
                                    </a>
                                </div>
                                <div class="section-products__list-bottom-pagination-current">
                                    Showing 1 to 12 of 24 (2 pages)
                                </div>
                            </div> -->
                            <div class="pagination justify-content-lg-end pl-4">
                                <?php
// PHẦN HIỂN THỊ PHÂN TRANG
// BƯỚC 7: HIỂN THỊ PHÂN TRANG

$currentURL = $_SERVER['QUERY_STRING'];
// nếu current_page > 1 và total_page > 1 mới hiển thị nút prev
if ($current_page > 1 && $total_page > 1) {
    echo '<a  class="btn btn-pagination btn-secondary" href="index.php?act=shoppage&page=' . ($current_page - 1) . '">Prev</a> | ';
}

// Lặp khoảng giữa
for ($i = 1; $i <= $total_page; $i++) {
    // Nếu là trang hiện tại thì hiển thị thẻ span
    // ngược lại hiển thị thẻ a
    if ($i == $current_page) {

        echo '<span class="btn btn-pagination btn-primary">' . $i . '</span> | ';
    } else {
        echo '<a class="btn btn-pagination btn-light" href="index.php?act=shoppage&page=' . $i . '">' . $i . '</a> | ';
    }
}

// nếu current_page < $total_page và total_page > 1 mới hiển thị nút Next

if ($current_page < $total_page && $total_page > 1) {
    echo '<a class="btn btn-pagination btn-secondary" href="index.php?act=shoppage&page=' . ($current_page + 1) . '">Next</a> | ';
}

?>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <!-- Recently view products -->
        <div class="recent-products">
            <h2 class="recent-products__title section-heading">RECENTLY VIEW PRODUCTS</h2>
            <div class="product-list tablet-product-list">
                <div class="product-item col-3">
                    <p class="product-item__bandage">New Arrival</p>
                    <p class="product-item__sold-quantity">12 sold</p>
                    <div class="product-item__img-container">
                        <img src="./assets/images/for-women/Running Shorts img.png" alt=""
                            class="product-item__img-img">
                        <p class="product-item__img-quick-view">
                            Quick View
                        </p>
                    </div>
                    <div class="product-item__body">
                        <h3 class="product-item__name">Running Shorts</h3>
                        <span class="product-item__divider"></span>
                        <div class="product-item__price">
                            <span class="product-item__price-old">$19.00</span>
                            <span class="product-item__price-new">$11.00</span>
                        </div>

                        <div class="product-item__rating-stars">
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                        </div>

                    </div>
                </div>
                <div class="product-item col-3">
                    <p class="product-item__bandage">New Arrival</p>
                    <p class="product-item__sold-quantity">12 sold</p>
                    <div class="product-item__img-container">
                        <img src="./assets/images/for-women/running short blue 3.png" alt=""
                            class="product-item__img-img">
                        <p class="product-item__img-quick-view">
                            Quick View
                        </p>
                    </div>
                    <div class="product-item__body">
                        <h3 class="product-item__name">Running Shorts</h3>
                        <span class="product-item__divider"></span>
                        <div class="product-item__price">
                            <span class="product-item__price-old">$32.00</span>
                            <span class="product-item__price-new">$23.00</span>
                        </div>

                        <div class="product-item__rating-stars">
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                        </div>

                    </div>
                </div>
                <div class="product-item col-3">
                    <p class="product-item__bandage">New Arrival</p>
                    <p class="product-item__sold-quantity">12 sold</p>
                    <div class="product-item__img-container">
                        <img src="./assets/images/for-women/running short dark grey.png" alt=""
                            class="product-item__img-img">
                        <p class="product-item__img-quick-view">
                            Quick View
                        </p>
                    </div>
                    <div class="product-item__body">
                        <h3 class="product-item__name">Running Shorts</h3>
                        <span class="product-item__divider"></span>
                        <div class="product-item__price">
                            <span class="product-item__price-old">$21.00</span>
                            <span class="product-item__price-new">$16.00</span>
                        </div>

                        <div class="product-item__rating-stars">
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                        </div>

                    </div>
                </div>
                <div class="product-item col-3">
                    <p class="product-item__bandage">New Arrival</p>
                    <p class="product-item__sold-quantity">12 sold</p>
                    <div class="product-item__img-container">
                        <img src="./assets/images/for-women/Seamless Bra (1) 1.png" alt=""
                            class="product-item__img-img">
                        <p class="product-item__img-quick-view">
                            Quick View
                        </p>
                    </div>
                    <div class="product-item__body">
                        <h3 class="product-item__name">Running Shorts</h3>
                        <span class="product-item__divider"></span>
                        <div class="product-item__price">
                            <span class="product-item__price-old">$23.00</span>
                            <span class="product-item__price-new">$20.00</span>
                        </div>

                        <div class="product-item__rating-stars">
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--yellow fa-solid fa-star"></i>
                            <i class="product-item__rating-icon product-item__rating-icon--black fa-solid fa-star"></i>
                        </div>

                    </div>
                </div>
                <!-- Next button control -->
                <div class="control-btn control__next-btn product-item__next-btn hide-on-tablet-mobile">
                    <i class="control-btn-icon fa-solid fa-chevron-right fa-xl"></i>
                </div>
                <div class="control-btn control__prev-btn product-item__prev-btn hide-on-tablet-mobile">
                    <i class="control-btn-icon fa-solid fa-chevron-left fa-xl"></i>
                </div>

            </div>
        </div>

        <!-- Brands section -->
        <div class="brands">
            <div class="grid wide">
                <div class="brands__heading">
                    <h2 class="brands__title section-heading">Brands</h2>
                    <div class="control-btns">
                        <div class="brands-control control-btn brands__prev-btn">
                            <i class="control-btn-icon brands-control-icon fa-solid fa-chevron-left fa-xl"></i>
                        </div>
                        <div class="brands-control control-btn brands__next-btn">
                            <i class="control-btn-icon brands-control-icon fa-solid fa-chevron-right fa-xl"></i>
                        </div>
                    </div>

                </div>
                <div class="brands__items">
                    <div class="brands__item">
                        <img src="./assets/images/brands/L-Wear.png" alt="" class="brands__item-img">
                    </div>
                    <div class="brands__item">
                        <img src="./assets/images/brands/Only.png" alt="" class="brands__item-img">
                    </div>
                    <div class="brands__item">
                        <img src="./assets/images/brands/The Code.png" alt="" class="brands__item-img">
                    </div>
                    <div class="brands__item">
                        <img src="./assets/images/brands/Ultimate.png" alt="" class="brands__item-img">
                    </div>
                    <div class="brands__item">
                        <img src="./assets/images/brands/Unknown.png" alt="" class="brands__item-img">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Code PHP here to filter product -->
<?php

?>